<!DOCTYPE html>
<html>
<head>
    <title>Car Dash</title>
    <style>
        body { margin: 0; padding: 0; background: #2c3e50; }
        #ui { position: absolute; top: 20px; left: 20px; color: white; font-family: Arial; z-index: 100; }
        #instructions { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                       background: rgba(0,0,0,0.8); color: white; padding: 20px; border-radius: 10px; 
                       text-align: center; }
    </style>
</head>
<body>
    <div id="ui">
        <div>Speed: <span id="speed">0</span> mph</div>
        <div>Distance: <span id="distance">0</span> m</div>
    </div>
    <div id="instructions">
        <h2>Car Dash</h2>
        <p>Use LEFT/RIGHT arrows to steer</p>
        <p>UP arrow to accelerate, DOWN to brake</p>
        <button onclick="startGame()">Start Race</button>
    </div>
    <canvas id="gameCanvas"></canvas>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, car, road, obstacles = [];
        let speed = 0, distance = 0, gameStarted = false;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('gameCanvas') });
            renderer.setSize(window.innerWidth, window.innerHeight);

            // Create road
            const roadGeometry = new THREE.PlaneGeometry(8, 500);
            const roadMaterial = new THREE.MeshBasicMaterial({ color: 0x333333 });
            road = new THREE.Mesh(roadGeometry, roadMaterial);
            road.rotation.x = -Math.PI / 2;
            scene.add(road);

            // Add road markings
            for (let i = -200; i < 200; i += 4) {
                const lineGeometry = new THREE.PlaneGeometry(0.5, 2);
                const lineMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
                const line = new THREE.Mesh(lineGeometry, lineMaterial);
                line.rotation.x = -Math.PI / 2;
                line.position.set(0, 0.1, i);
                scene.add(line);
            }

            // Create car
            const carGeometry = new THREE.BoxGeometry(1, 0.5, 2);
            const carMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
            car = new THREE.Mesh(carGeometry, carMaterial);
            car.position.y = 0.5;
            scene.add(car);

            camera.position.set(0, 5, 5);
            camera.lookAt(0, 0, 0);

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 20, 10);
            scene.add(directionalLight);
        }

        function startGame() {
            document.getElementById('instructions').style.display = 'none';
            gameStarted = true;
            speed = 0;
            distance = 0;
            animate();
        }

        function createObstacle() {
            const geometry = new THREE.BoxGeometry(1, 1, 1);
            const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
            const obstacle = new THREE.Mesh(geometry, material);
            obstacle.position.x = (Math.random() - 0.5) * 6;
            obstacle.position.z = -50;
            obstacle.position.y = 0.5;
            scene.add(obstacle);
            obstacles.push(obstacle);
        }

        function animate() {
            if (!gameStarted) return;

            requestAnimationFrame(animate);

            // Move obstacles
            obstacles.forEach((obs, index) => {
                obs.position.z += speed * 0.1;
                if (obs.position.z > 10) {
                    scene.remove(obs);
                    obstacles.splice(index, 1);
                }
            });

            // Update distance and speed display
            distance += speed * 0.1;
            document.getElementById('speed').textContent = Math.round(speed * 10);
            document.getElementById('distance').textContent = Math.round(distance);

            // Random obstacles
            if (Math.random() < 0.02) createObstacle();

            renderer.render(scene, camera);
        }

        // Keyboard controls
        const keys = {};
        document.addEventListener('keydown', (event) => {
            keys[event.key] = true;
            if (!gameStarted && (event.key === 'ArrowUp' || event.key === ' ')) {
                startGame();
            }
        });
        
        document.addEventListener('keyup', (event) => {
            keys[event.key] = false;
        });

        function handleInput() {
            if (!gameStarted) return;

            if (keys['ArrowUp']) speed = Math.min(speed + 0.1, 5);
            if (keys['ArrowDown']) speed = Math.max(speed - 0.2, 0);
            if (keys['ArrowLeft'] && car.position.x > -3) car.position.x -= 0.1;
            if (keys['ArrowRight'] && car.position.x < 3) car.position.x -= -0.1;

            // Natural speed decrease
            speed = Math.max(speed - 0.01, 0);
        }

        setInterval(handleInput, 16);

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>
</html>